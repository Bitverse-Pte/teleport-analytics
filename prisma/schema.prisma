// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model TelegramGroup {
  id    Int @default(autoincrement()) @id
  chatId Decimal @db.Decimal(65, 0)
}

model TelegramChatMember {
  id    Int @default(autoincrement()) @id
  // telegram user's id
  userId Decimal @db.Decimal(65, 0)
  // group's id
  groupId Decimal @db.Decimal(65, 0)

  joinAt DateTime @default(now())

  messageCount Int @default(0)
  lastSeen DateTime @default(now())
  activeDays Int @default(0)
}

model TelegramGroupDailyStat {
  id    Int     @default(autoincrement()) @id
  // telegram group id
  groupId Decimal @db.Decimal(65, 0)
  date  DateTime @default(now())

  newMemberCount Int
  activeNewMemberCount Int
  messageCount Int
  // active member means anyone that send at least 1 message in group
  activeMemberCount Int
  totalMemberCount Int
}

model TwitterAccount {
    id Int @default(autoincrement()) @id
    name String
    username String
    accountId String @unique
    accessToken String
    refreshToken String
    expiresAt DateTime

    followersCount Int @default(0)
    tweetCount Int @default(0)
}

model TwitterAccountRealTimeStat {
    id Int @default(autoincrement()) @id
    // TwitterAccount id
    twitterAccountId String
    date DateTime @default(now())
    followersCount Int @default(0)
    followingCount Int @default(0)
    tweetCount Int @default(0)
    listedCount Int @default(0)

    @@index([twitterAccountId])
}

model TwitterAccountDailyStat {
    id Int @default(autoincrement()) @id
    // TwitterAccount id
    twitterAccountId String
    date DateTime @default(now())
    followersCount Int @default(0)
    newFollowersCount Int @default(0)
    tweetCount Int @default(0)

     @@index([twitterAccountId])
}

model Tweet {
    id Int @default(autoincrement()) @id
    tweetId String @unique
    // TwitterAccount id
    twitterAccountId String
    createdAt DateTime
    text String

    impressions Int @default(0)
    retweets Int @default(0)
    quoteTweets Int @default(0)
    likes Int @default(0)
    replies Int @default(0)
    urlLinkClicks Int @default(0)
    userProfileClicks Int @default(0)
    videoViews Int @default(0)

     @@index([twitterAccountId, tweetId])
}

model TweetsDailyStat {
    id Int @default(autoincrement()) @id
    date DateTime @default(now())
    tweetsCount Int @default(0)

    impressions Int @default(0)
    retweets Int @default(0)
    quoteTweets Int @default(0)
    likes Int @default(0)
    replies Int @default(0)
    urlLinkClicks Int @default(0)
    userProfileClicks Int @default(0)
    videoViews Int @default(0)
}

model TweetRealTimeStat {
    id Int @default(autoincrement()) @id
    tweetId String
    date DateTime @default(now())

    impressions Int @default(0)
    retweets Int @default(0)
    quoteTweets Int @default(0)
    likes Int @default(0)
    replies Int @default(0)
    urlLinkClicks Int @default(0)
    userProfileClicks Int @default(0)
    videoViews Int @default(0)

    @@index([tweetId])
}
